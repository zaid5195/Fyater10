<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- --- 1. ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙˆØµÙÙŠØ© (SEO Meta Tags) --- -->
    <title>VATICA | Ø¨Ø±Ù†Ø§Ù…Ø¬ ÙÙˆØ§ØªÙŠØ± Ù…Ø¬Ø§Ù†ÙŠ - Ø¥Ù†Ø´Ø§Ø¡ ÙÙˆØ§ØªÙŠØ± Ø§Ø­ØªØ±Ø§ÙÙŠØ© PDF ÙˆÙˆØ§ØªØ³Ø§Ø¨</title>
    <meta name="description" content="Ø£Ù†Ø´Ø¦ ÙÙˆØ§ØªÙŠØ±Ùƒ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ© Ù…Ø¬Ø§Ù†Ø§Ù‹ Ù…Ø¹ VATICA. Ø¯Ø¹Ù… ÙƒØ§Ù…Ù„ Ù„Ù„Ø¶Ø±ÙŠØ¨Ø©ØŒ ØªÙˆÙ‚ÙŠØ¹ Ø±Ù‚Ù…ÙŠØŒ ÙˆÙ‚ÙˆØ§Ù„Ø¨ Ø¹ØµØ±ÙŠØ©. Ø£Ø±Ø³Ù„ ÙÙˆØ§ØªÙŠØ±Ùƒ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨ ÙÙŠ Ø«ÙˆØ§Ù†Ù. Ø§Ù„Ø­Ù„ Ø§Ù„Ø£Ù…Ø«Ù„ Ù„Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„ØµØºÙŠØ±Ø© ÙˆØ§Ù„Ù…ØªÙˆØ³Ø·Ø©.">
    <meta name="keywords" content="Ø¨Ø±Ù†Ø§Ù…Ø¬ ÙÙˆØ§ØªÙŠØ± Ù…Ø¬Ø§Ù†ÙŠ, Ù†Ù…ÙˆØ°Ø¬ ÙØ§ØªÙˆØ±Ø© Ø¶Ø±ÙŠØ¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©, Ø¥Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø© PDF, Free Invoice Generator, Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©, ÙØ§ØªÙˆØ±Ø© ÙˆØ§ØªØ³Ø§Ø¨">
    <meta name="author" content="VATICA Team">
    
    <!-- Open Graph (Ù„ØªØ­Ø³ÙŠÙ† Ø´ÙƒÙ„ Ø§Ù„Ø±Ø§Ø¨Ø· Ø¹Ù†Ø¯ Ù…Ø´Ø§Ø±ÙƒØªÙ‡ ÙÙŠ ÙˆØ§ØªØ³Ø§Ø¨ ÙˆÙÙŠØ³Ø¨ÙˆÙƒ) -->
    <meta property="og:title" content="VATICA | Ø¨Ø±Ù†Ø§Ù…Ø¬ ÙÙˆØ§ØªÙŠØ± Ø§Ø­ØªØ±Ø§ÙÙŠ Ù…Ø¬Ø§Ù†ÙŠ">
    <meta property="og:description" content="Ø£Ø¯Ø§Ø© Ø°ÙƒÙŠØ© Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙÙˆØ§ØªÙŠØ± Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠØ© Ø¨ØµÙŠØºØ© PDF Ù…Ø¹ Ù…ÙŠØ²Ø© Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø±Ù‚Ù…ÙŠ.">
    <meta property="og:type" content="website">

    <!-- AdSense & Analytics -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2161407887612919" crossorigin="anonymous"></script>
    <script defer src="/_vercel/insights/script.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;500;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <style>
        :root { --v-blue: #0f172a; --v-primary: #2563eb; --v-text: #1e293b; --bg-light: #f1f5f9; }
        * { box-sizing: border-box; font-family: 'Tajawal', sans-serif; }
        body { margin: 0; background-color: var(--bg-light); color: var(--v-text); }
        
        header.vatica-nav { background: var(--v-blue); color: white; padding: 15px 5%; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 1000; }
        .vatica-logo { font-size: 26px; font-weight: 700; letter-spacing: 2px; }
        .vatica-logo span { color: var(--v-primary); }

        .container { display: flex; max-width: 1400px; margin: 20px auto; padding: 0 20px; gap: 30px; }
        aside.controls { width: 320px; background: white; padding: 25px; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.05); height: fit-content; position: sticky; top: 90px; }
        main.editor { flex: 1; transition: 0.3s; }

        /* Templates */
        .card { background: white; padding: 50px; min-height: 297mm; position: relative; transition: all 0.4s ease; box-shadow: 0 10px 40px rgba(0,0,0,0.05); }
        .template-modern { border-top: 10px solid var(--v-primary); }
        .template-classic { border: 2px solid #334155; }
        .template-classic .invoice-head { background: #334155; color: white; padding: 20px; margin: -50px -50px 30px -50px; }
        .template-elegant { border-right: 20px solid var(--v-primary); }

        .invoice-head { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 40px; }
        .logo-box { width: 150px; height: 100px; border: 2px dashed #ddd; display: flex; align-items: center; justify-content: center; overflow: hidden; position: relative; }
        .logo-box img { max-width: 100%; max-height: 100%; object-fit: contain; }
        .logo-box input { position: absolute; opacity: 0; width: 100%; height: 100%; cursor: pointer; }

        .v-table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        .v-table th { padding: 12px; font-size: 13px; text-align: inherit; background: #f8fafc; }
        .v-table td { padding: 12px; border-bottom: 1px solid #f1f5f9; }
        .v-table input { border: none; width: 100%; outline: none; background: transparent; }

        /* SEO Content Section */
        .seo-section { max-width: 1000px; margin: 50px auto; padding: 40px; background: white; border-radius: 16px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        .seo-section h2 { color: var(--v-primary); border-bottom: 2px solid var(--bg-light); padding-bottom: 10px; }
        .seo-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-top: 20px; }
        .seo-box h3 { font-size: 18px; color: var(--v-blue); }
        .seo-box p { font-size: 14px; line-height: 1.8; color: #64748b; }

        .btn-action { width: 100%; padding: 14px; border-radius: 12px; border: none; font-weight: bold; cursor: pointer; margin-bottom: 10px; display: flex; align-items: center; justify-content: center; gap: 10px; transition: 0.3s; }
        .btn-download { background: var(--v-primary); color: white; }
        .btn-whatsapp { background: #22c55e; color: white; }

        footer { background: var(--v-blue); color: #94a3b8; padding: 40px 5%; text-align: center; margin-top: 50px; }
        .footer-links { margin-bottom: 20px; }
        .footer-links a { color: white; text-decoration: none; margin: 0 15px; font-size: 14px; }

        @media (max-width: 900px) { .container { flex-direction: column; } aside.controls { width: 100%; position: relative; top: 0; } .seo-grid { grid-template-columns: 1fr; } }
        @media print { .no-print, .seo-section, footer, header { display: none !important; } .card { box-shadow: none; border: none; width: 100%; padding: 0; } }
    </style>
</head>
<body>

    <header class="vatica-nav no-print">
        <div class="vatica-logo">VATICA<span>.io</span></div>
        <div style="font-size: 12px;">Ø£ÙØ¶Ù„ Ø¨Ø±Ù†Ø§Ù…Ø¬ ÙÙˆØ§ØªÙŠØ± Ø¶Ø±ÙŠØ¨ÙŠØ© Ù…Ø¬Ø§Ù†ÙŠ âœ¨</div>
    </header>

    <div class="container">
        <aside class="controls no-print">
            <h3>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h3>
            <div style="display:flex; gap:5px; margin: 10px 0 20px 0;">
                <button class="tpl-btn active" onclick="changeTpl('modern', this)" style="flex:1; padding:8px; cursor:pointer;">Ø¹ØµØ±ÙŠ</button>
                <button class="tpl-btn" onclick="changeTpl('classic', this)" style="flex:1; padding:8px; cursor:pointer;">ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠ</button>
            </div>

            <div style="margin-bottom:15px">
                <label style="font-size:12px; font-weight:bold;">Ø§Ù„Ø¹Ù…Ù„Ø©:</label>
                <select id="currency" onchange="calculate()" style="width:100%; padding:10px; border-radius:8px;">
                    <option value="SAR">SAR (Ø±ÙŠØ§Ù„)</option>
                    <option value="USD">USD (Ø¯ÙˆÙ„Ø§Ø±)</option>
                </select>
            </div>
            
            <button class="btn-action btn-download" onclick="finalizeInvoice()">ğŸ“¥ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø© (PDF)</button>
            <button class="btn-action btn-whatsapp" onclick="sendWhatsApp()">ğŸ’¬ Ø¥Ø±Ø³Ø§Ù„ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</button>
        </aside>

        <main class="editor">
            <!-- Ø§Ù„ÙØ§ØªÙˆØ±Ø© (Ù…Ø­ØªÙˆÙ‰ Ù…Ø±Ø¦ÙŠ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ¬ÙˆØ¬Ù„) -->
            <article class="card template-modern" id="invoiceCard">
                <header class="invoice-head">
                    <div style="flex:1">
                        <div class="logo-box no-print">
                            <img id="logoImg" src="" style="display:none;" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ø´Ø±ÙƒØ© ÙÙŠ Ø§Ù„ÙØ§ØªÙˆØ±Ø©">
                            <span id="logoText">Ø±ÙØ¹ Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø¤Ø³Ø³Ø©</span>
                            <input type="file" accept="image/*" onchange="loadLogo(this)" title="ØªØ­Ù…ÙŠÙ„ Ø´Ø¹Ø§Ø± Ø§Ù„ÙØ§ØªÙˆØ±Ø©">
                        </div>
                        <div id="printLogo" style="display:none; width:150px; height:100px;"></div>
                        <input type="text" class="company-field" id="compName" oninput="saveComp(this.value)" placeholder="Ø§Ø³Ù… Ø´Ø±ÙƒØªÙƒ Ø£Ùˆ Ù…Ø¤Ø³Ø³ØªÙƒ...">
                    </div>
                    <div id="qrcode" title="Ø±Ù…Ø² QR Ù„Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠØ©"></div>
                </header>

                <section class="input-grid">
                    <div class="field-group">
                        <label>Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠØ©</label>
                        <input type="text" id="invNum" readonly>
                        <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø±</label>
                        <input type="date" id="invDate">
                    </div>
                    <div class="field-group">
                        <label>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ / Ø§Ù„Ù…Ø¤Ø³Ø³Ø©</label>
                        <input type="text" id="clientName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù‡Ù†Ø§...">
                        <label>Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠ Ù„Ù„Ø¹Ù…ÙŠÙ„</label>
                        <input type="text" placeholder="300XXXXXXXXXXXX">
                    </div>
                </section>

                <table class="v-table">
                    <thead>
                        <tr><th>ÙˆØµÙ Ø§Ù„Ø®Ø¯Ù…Ø© Ø£Ùˆ Ø§Ù„Ù…Ù†ØªØ¬</th><th width="80">Ø§Ù„ÙƒÙ…ÙŠØ©</th><th width="120">Ø§Ù„Ø³Ø¹Ø±</th><th width="120">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th></tr>
                    </thead>
                    <tbody id="tbody"></tbody>
                </table>
                <button class="btn-add-item no-print" onclick="addRow()" style="width:100%; padding:10px; cursor:pointer;">+ Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¯ Ø¬Ø¯ÙŠØ¯</button>

                <footer style="display:flex; justify-content:space-between; margin-top:40px; gap:30px;">
                    <div style="flex:1">
                        <label style="font-weight:bold; font-size:12px">Ù…Ù„Ø§Ø­Ø¸Ø§Øª ÙˆØ´Ø±ÙˆØ· Ø§Ù„ÙØ§ØªÙˆØ±Ø©:</label>
                        <textarea id="notes" style="width:100%; height:80px; border:1px solid #eee; border-radius:8px; padding:10px; resize:none;" placeholder="Ø´Ø±ÙˆØ· Ø§Ù„Ø¯ÙØ¹..."></textarea>
                        <div id="tafqit" style="font-size:12px; color:var(--v-primary); font-weight:bold; margin-top:10px;"></div>
                    </div>
                    <div style="width:280px; background:#f8fafc; padding:20px; border-radius:12px;">
                        <div style="display:flex; justify-content:space-between; margin-bottom:10px;"><span>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</span><span id="subTotal">0.00</span></div>
                        <div style="display:flex; justify-content:space-between; font-weight:bold; font-size:20px; color:var(--v-primary); border-top:1px solid #ddd; padding-top:10px;">
                            <span>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒÙ„ÙŠ</span><span id="grandTotal">0.00</span>
                        </div>
                    </div>
                </footer>
            </article>

            <!-- --- 3. ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù†ØµÙŠ (SEO Content Section) --- -->
            <section class="seo-section no-print">
                <h2>Ø­ÙˆÙ„ Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ÙÙˆØ§ØªÙŠØ± Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠ VATICA</h2>
                <div class="seo-grid">
                    <div class="seo-box">
                        <h3>ÙƒÙŠÙÙŠØ© Ø¥Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø© Ø¶Ø±ÙŠØ¨ÙŠØ© ÙÙŠ Ø«ÙˆØ§Ù†ÙØŸ</h3>
                        <p>ØªØ¹ØªØ¨Ø± VATICA Ø£ÙØ¶Ù„ <strong>Ø¨Ø±Ù†Ø§Ù…Ø¬ ÙÙˆØ§ØªÙŠØ± Ø¨Ø³ÙŠØ·</strong> ØµÙÙ…Ù… Ø®ØµÙŠØµØ§Ù‹ Ù„Ù„Ù…Ø¤Ø³Ø³Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø©. Ù„Ø¨Ø¯Ø¡ Ø¥Ù†Ø´Ø§Ø¡ <strong>Ù†Ù…ÙˆØ°Ø¬ ÙØ§ØªÙˆØ±Ø© Ø¶Ø±ÙŠØ¨ÙŠØ©</strong>ØŒ Ù‚Ù… Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø´Ø±ÙƒØªÙƒØŒ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ØŒ ÙˆØ§Ù„Ù…Ù†ØªØ¬Ø§Øª. Ø§Ù„Ù†Ø¸Ø§Ù… Ø³ÙŠÙ‚ÙˆÙ… Ø¨Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙˆØªÙÙ‚ÙŠØ· Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø§Ù„ÙƒÙ„Ù…Ø§Øª.</p>
                    </div>
                    <div class="seo-box">
                        <h3>Ù…Ù…ÙŠØ²Ø§Øª Ø¥Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø© PDF Ù…Ø¹ VATICA</h3>
                        <p>Ù†Ø­Ù† Ù†ÙˆÙØ± Ù„Ùƒ Ø£Ø¯Ø§Ø© <strong>Free Invoice Generator</strong> Ø´Ø§Ù…Ù„Ø© ØªØ¯Ø¹Ù… Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø±Ù‚Ù…ÙŠ ÙˆØ±Ù…Ø² QR Ø§Ù„Ù…ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ù…ØªØ·Ù„Ø¨Ø§Øª Ù‡ÙŠØ¦Ø© Ø§Ù„Ø²ÙƒØ§Ø© ÙˆØ§Ù„Ø¶Ø±ÙŠØ¨Ø© ÙˆØ§Ù„Ø¬Ù…Ø§Ø±Ùƒ. ÙŠÙ…ÙƒÙ†Ùƒ Ø£ÙŠØ¶Ø§Ù‹ <strong>Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</strong> Ù…Ø¨Ø§Ø´Ø±Ø© Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡ Ù„Ø²ÙŠØ§Ø¯Ø© Ø³Ø±Ø¹Ø© Ø§Ù„ØªØ­ØµÙŠÙ„.</p>
                    </div>
                </div>
                <div class="seo-box" style="margin-top:20px;">
                    <h3>ÙÙˆØ§Ø¦Ø¯ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙÙˆØ§ØªÙŠØ± Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©</h3>
                    <p>ÙŠØ³Ø§Ø¹Ø¯Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙÙˆØ§ØªÙŠØ± Ø§Ù„Ø±Ù‚Ù…ÙŠØ© ÙÙŠ ØªÙ†Ø¸ÙŠÙ… Ø­Ø³Ø§Ø¨Ø§ØªÙƒ ÙˆØªØ¬Ù†Ø¨ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„ÙŠØ¯ÙˆÙŠØ©. VATICA ØªØ¶Ù…Ù† Ù„Ùƒ Ø§Ù„Ø®ØµÙˆØµÙŠØ©ØŒ Ø­ÙŠØ« ÙŠØªÙ… ØªØ®Ø²ÙŠÙ† ÙƒØ§ÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ù…ØªØµÙØ­Ùƒ ÙˆÙ„Ø§ ÙŠØªÙ… Ø±ÙØ¹Ù‡Ø§ Ø¹Ù„Ù‰ Ø£ÙŠ Ø®ÙˆØ§Ø¯Ù… Ø®Ø§Ø±Ø¬ÙŠØ©ØŒ Ù…Ù…Ø§ ÙŠØ¬Ø¹Ù„Ù‡Ø§ Ø£Ø³Ø±Ø¹ ÙˆØ£ÙƒØ«Ø± Ø£Ù…Ø§Ù†Ø§Ù‹.</p>
                </div>
            </section>
        </main>
    </div>

    <footer>
        <div class="footer-links">
            <a href="#">Ù…Ù† Ù†Ø­Ù†</a>
            <a href="#">Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</a>
            <a href="#">Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</a>
        </div>
        <p>Â© 2024 VATICA.io - Ø§Ù„Ø­Ù„ Ø§Ù„Ø£Ù…Ø«Ù„ Ù„Ø¥Ù†Ø´Ø§Ø¡ <strong>ÙÙˆØ§ØªÙŠØ± Ø¶Ø±ÙŠØ¨ÙŠØ© Ø§Ø­ØªØ±Ø§ÙÙŠØ©</strong> Ù…Ø¬Ø§Ù†Ø§Ù‹.</p>
    </footer>

    <script>
        // --- Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª ---
        window.onload = () => {
            document.getElementById('invDate').valueAsDate = new Date();
            document.getElementById('invNum').value = localStorage.getItem('v_count') || 1001;
            const name = localStorage.getItem('v_name'); if(name) document.getElementById('compName').value = name;
            const logo = localStorage.getItem('v_logo'); if(logo) renderLogo(logo);
            addRow();
        };

        function addRow() {
            const tbody = document.getElementById("tbody");
            const row = document.createElement("tr");
            row.innerHTML = `<td><input type="text" placeholder="Ù…Ø«Ù„Ø§Ù‹: ØªØµÙ…ÙŠÙ… Ù…ÙˆÙ‚Ø¹ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ"></td><td><input type="number" class="qty" value="1" oninput="calculate()"></td><td><input type="number" class="price" value="0.00" oninput="calculate()"></td><td style="font-weight:bold" class="line-total">0.00</td>`;
            tbody.appendChild(row); calculate();
        }

        function calculate() {
            let sub = 0; const curr = document.getElementById("currency").value;
            document.querySelectorAll("#tbody tr").forEach(row => {
                const q = parseFloat(row.querySelector(".qty").value) || 0;
                const p = parseFloat(row.querySelector(".price").value) || 0;
                const total = q * p; row.querySelector(".line-total").innerText = total.toFixed(2);
                sub += total;
            });
            const total = sub * 1.15; // Ø´Ø§Ù…Ù„ Ø¶Ø±ÙŠØ¨Ø© 15%
            document.getElementById("subTotal").innerText = sub.toFixed(2) + " " + curr;
            document.getElementById("grandTotal").innerText = total.toFixed(2) + " " + curr;
            document.getElementById("tafqit").innerText = "Ø§Ù„Ù…Ø¨Ù„Øº ÙƒØªØ§Ø¨Ø©: " + total.toFixed(2) + " " + curr;
            updateQR(total, curr);
        }

        function updateQR(total, curr) {
            const qr = document.getElementById("qrcode"); qr.innerHTML = "";
            new QRCode(qr, { text: "VATICA Invoice Total: " + total.toFixed(2) + " " + curr, width: 80, height: 80 });
        }

        function sendWhatsApp() {
            const client = document.getElementById('clientName').value.trim();
            const total = document.getElementById('grandTotal').innerText;
            if(!client) return alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹.");
            const msg = `Ø£Ù‡Ù„Ø§Ù‹ ${client}ØŒ ØªÙ… Ø¥ØµØ¯Ø§Ø± ÙØ§ØªÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù„Ùƒ Ø¨Ù…Ø¨Ù„Øº ${total}. ÙŠÙ…ÙƒÙ†Ùƒ Ù…Ø´Ø§Ù‡Ø¯ØªÙ‡Ø§ Ø¹Ø¨Ø± Vatica.io`;
            window.open(`https://api.whatsapp.com/send?text=${encodeURIComponent(msg)}`, '_blank');
        }

        function loadLogo(input) {
            const reader = new FileReader();
            reader.onload = (e) => { localStorage.setItem('v_logo', e.target.result); renderLogo(e.target.result); };
            reader.readAsDataURL(input.files[0]);
        }

        function renderLogo(data) {
            document.getElementById('logoText').style.display = 'none';
            document.getElementById('logoImg').src = data;
            document.getElementById('logoImg').style.display = 'block';
            document.getElementById('printLogo').innerHTML = `<img src="${data}" style="width:100%">`;
            document.getElementById('printLogo').style.display = 'block';
        }

        function changeTpl(tpl, btn) {
            document.getElementById('invoiceCard').className = 'card template-' + tpl;
            document.querySelectorAll('.tpl-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }

        function saveComp(v) { localStorage.setItem('v_name', v); }
        function finalizeInvoice() { localStorage.setItem('v_count', parseInt(document.getElementById('invNum').value) + 1); window.print(); }
    </script>
</body>
</html>
